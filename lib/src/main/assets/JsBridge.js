(function(){if(window.AEJSBridge){return}var q;var b=[];var m={};var g={};var c="yy";var a="__QUEUE_MESSAGE__/";var f=1;function n(s){q=s.createElement("iframe");q.style.display="none";s.documentElement.appendChild(q)}function i(s){if(!s.exec&&s.callback){s.exec=s.callback;s.callback=null}if(!s||!s.handlerName||!s.exec){return}if(!m[s.handlerName]){m[s.handlerName]=[]}m[s.handlerName].push(s.exec);if(s.callback){s.callback({msg:"add success ~",code:0})}}function j(v){if(!v||!v.handlerName||!v.exec){return}var t=m[v.handlerName];var s=false;for(var u=0;u<t.length;u++){if(t[u]===v.exec){t.splice(u,1);s=true;break}}if(v.callback){v.callback({msg:s?"delete success ~":"delete failed ~",code:s?0:-1})}}function p(s){console.log("dispatch："+s);if(!s||!s.handlerName){return}if(s.callback){var t="cb_"+(f++)+"_"+new Date().getTime();g[t]=s.callback;s.callbackId=t}b.push(s);q.src=c+"://"+a}function k(t){if(!t||!t.handlerName){return}console.log(JSON.stringify(t.params));var s=(AEJSBridgeSync.dispatchSync(t.handlerName,JSON.stringify(t.params)));console.log(s);try{return JSON.parse(s)}catch(u){return s}}function d(){var s=JSON.stringify(b);b=[];q.src=c+"://return/_fetchQueue/"+encodeURIComponent(s)}function e(s){setTimeout(function(){var x=JSON.parse(s);var t;var v;try{v=JSON.parse(x.data)}catch(w){v=x.data}if(x.responseId){t=g[x.responseId];if(!t){return}t({data:(typeof v=="string")?decodeURIComponent(v):v,msg:x.msg,code:x.code});delete g[x.responseId]}else{if(x.callbackId){var y=x.callbackId;t=function(z){b.push({responseId:y,data:z});q.src=c+"://"+a}}var u;if(!x.handlerName){console.log("handlerName is empty ...");return}u=m[x.handlerName];if(!u){t({msg:"事件暂未注册~",code:"-1"});console.log("handlerName callbacks is empty ...");return}u.forEach(function(z){z({data:(typeof v=="string")?decodeURIComponent(v):v,msg:x.msg,code:x.code},t)})}})}function l(s){e(s)}var o=window.AEJSBridge={addEventListener:i,removeEventListener:j,dispatch:p,dispatchSync:k,_fetchQueue:d,_handleMessageFromNative:l};var r=document;n(r);var h=r.createEvent("Events");h.initEvent("AEJSBridgeReady");h.bridge=o;r.dispatchEvent(h)})();