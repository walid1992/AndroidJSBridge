window.__require=function t(e,i,a){function c(n,s){if(!i[n]){if(!e[n]){var r=n.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+n+"'")}}var h=i[n]={exports:{}};e[n][0].call(h.exports,function(t){return c(e[n][1][t]||t)},h,h.exports,t,e,i,a)}return i[n].exports}for(var o="function"==typeof __require&&__require,n=0;n<a.length;n++)c(a[n]);return c}({PlanetNode:[function(t,e,i){"use strict";cc._RF.push(e,"cf10545thZIgZQHODGg6TiB","PlanetNode"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],ShaderUtils:[function(t,e,i){"use strict";cc._RF.push(e,"94ba4wxlNpBYY1SSwmJALjy","ShaderUtils");var a={shaderMap:{},shaderPrograms:{},getGlPropgram:function(t,e){var i=new cc.GLProgram;return i.initWithString(t,e),cc.sys.isNative||(i.addAttribute(cc.macro.ATTRIBUTE_NAME_POSITION,cc.macro.VERTEX_ATTRIB_POSITION),i.addAttribute(cc.macro.ATTRIBUTE_NAME_COLOR,cc.macro.VERTEX_ATTRIB_COLOR),i.addAttribute(cc.macro.ATTRIBUTE_NAME_TEX_COORD,cc.macro.VERTEX_ATTRIB_TEX_COORDS)),i.link(),i.updateUniforms(),i},setShader:function(e,i){var a=this.shaderPrograms[i];if(!a){var c=t(cc.js.formatStr("%s.vert",i)),o=t(cc.js.formatStr("%s.frag",i));a=this.getGlPropgram(c,o),this.shaderPrograms[i]=a}return e._sgNode.setShaderProgram(a),a},useShader:function(t,e,i){var a=this.shaderPrograms[e];if(a)return t._sgNode.setShaderProgram(a),void(i&&i(a));var c=cc.js.formatStr("shader/%s.vert",e);this.shaderMap[c]?this.onLoadShader(c,e,i):cc.loader.loadRes(c,function(a,o){a?console.error("load %s fail, error: ",a):(this.shaderMap[c]=o,this.onLoadShader(t,e,i))}.bind(this));var o=cc.js.formatStr("shader/%s.frag",e);this.shaderMap[o]?this.onLoadShader(o,e,i):cc.loader.loadRes(o,function(a,c){a?console.error("load %s fail, error: ",a):(this.shaderMap[o]=c,this.onLoadShader(t,e,i))}.bind(this))},onLoadShader:function(t,e,i){var a=cc.js.formatStr("shader/%s.vert",e),c=cc.js.formatStr("shader/%s.frag",e);if(this.shaderMap[a]&&this.shaderMap[c]){var o=this.getGlPropgram(this.shaderMap[a],this.shaderMap[c]);this.shaderPrograms[e]=o,t._sgNode.setShaderProgram(o),i&&i(o)}}};e.exports=a,cc._RF.pop()},{}],SoulPlanet:[function(t,e,i){"use strict";cc._RF.push(e,"97f22e5d9FEQqAmAKsH/0ty","SoulPlanet"),cc.Class({extends:cc.Component,properties:{cells:[],cellsPoint:[],CELL_WH:0,cant:50,offset:0,increment:0,deltaAngle:1,beginTouchPos:0,isTouchMoving:!1,lastDirection:new cc.Vec3(0,0,0),lastAngle:0,beginScaleTouch0Pos:0,beginScaleTouch1Pos:0,radias:110,isScaleing:!1,sprAtlas:cc.SpriteAtlas,initing:!0,nodes:null,tipNode:cc.Node,tipIndex:0,tipClicked:!1},onLoad:function(){},start:function(){this.isScaleing=!1,this.offset=2/this.cant,this.increment=Math.PI*(3-Math.sqrt(5)),this.initing=!0,this.CELL_WH=20,this.nodes=[],this.tipNode.opacity=0,this.tipClicked=!1;var t=this;this.tipNode.on(cc.Node.EventType.TOUCH_END,function(e){t.tipHandle(t.tipIndex)},t);for(var e=JSON.parse('[{"authorIdEcpt": null,"userIdEcpt": "L2JiREROYmlZQUhWVlgvZUh1NEExdz09","targetUserIdEcpt": null,"subTargetUserIdEcpt": null,"replyToUserIdEcpt": null,"replyToAuthorIdEcpt": null, "msgToIdEcpt": null,"ownerIdEcpt": null,"targetIdEcpt": null,"actorIdEcpt": null,"parentAuthorIdEcpt": null,"soulmateUserIdEcpt": null,"postIdEcpt": null,"tagIdEcpt": null,"userId": -1,"signature": "\u597d\u597d\u804a\u5929","birthday": 0,"matchvalue": 0.93084013,"identity": null,"gender": "FEMALE","createTime": 1550579665000,"description": "","inExposure": false}]'),i=0;i<50;i++)this.nodes[i]=e[0];this.tipIndex=23,this.cant=this.nodes.length,this.createNodes(),this.updatePos(0),this.isTouchMoving=!1;var a=cc.EventListener.create({event:cc.EventListener.TOUCH_ALL_AT_ONCE,onTouchesBegan:function(e,i){return e.length>=2?(t.beginScaleTouch0Pos=e[0].getLocation(),t.beginScaleTouch1Pos=e[1].getLocation(),t.isTouchMoving=!1,t.isScaleing=!0,t.beginTouchPos=0):(t.isTouchMoving=!0,t.isScaleing=!1,t.beginTouchPos=e[0].getLocation()),t.beginDist=0,!0},onTouchesMoved:function(e,i){if(e.length>=2){t.beginScaleTouch0Pos=e[0].getLocation(),t.beginScaleTouch1Pos=e[1].getLocation();var a=t.beginScaleTouch1Pos.y-t.beginScaleTouch0Pos.y,c=t.beginScaleTouch1Pos.x-t.beginScaleTouch0Pos.x,o=Math.sqrt(a*a+c*c);0==t.beginDist&&(t.beginDist=o);var n=o/t.beginDist;t.beginDist=o,t.radias=Math.max(Math.min(120,t.radias*n),100),t.isScaleing=!0,t.isTouchMoving=!1}else{if(t.isScaleing)return;t.isTouchMoving=!0;var s=e[0].getLocation();0==t.beginTouchPos&&(t.beginTouchPos=s);var r=t.beginTouchPos.y-s.y,l=s.x-t.beginTouchPos.x,h=new cc.Vec3(r,l,0),d=Math.sqrt(h.x*h.x+h.y*h.y),u=Math.min(d/t.node.width,.1);t.rotationPos(h,u),t.beginTouchPos=s,t.lastDirection=h,t.lastAngle=u}},onTouchesEnded:function(e,i){e.length<=1&&t.isScaleing&&(t.beginDist=0),t.isTouchMoving=!1},onTouchesCancelled:function(e,i){e.length<=1&&t.isScaleing&&(t.beginDist=0),t.isTouchMoving=!1}});cc.eventManager.addListener(a,t.node)},parseData:function(t){return[]},getColor:function(){return new cc.color(600,600,600)},createNodes:function(){this.cells={};cc.view.getVisibleSize();for(var t=0;t<this.cant;t++){(function(t,e){var i=new cc.Node("Sprite");i.setAnchorPoint(.5,.5),t.node.addChild(i);var a=new cc.Node("pot");if(a.setAnchorPoint(.5,.5),i.addChild(a),e==t.tipIndex||t.nodes[e].inExposure){for(var c=a.addComponent(cc.Sprite).addComponent(cc.Animation),o=[],n=0;n<6;n++)o[n]=t.sprAtlas.getSpriteFrame("img_"+n);var s=cc.AnimationClip.createWithSpriteFrames(o,o.length);s.name="superplanet",s.speed=.5,s.wrapMode=cc.WrapMode.Loop,c.addClip(s),c.play("superplanet")}else a.addComponent(cc.Sprite).spriteFrame=t.sprAtlas.getSpriteFrame("img_4"),a.scale=.5;var r=new cc.Node("match");r.setAnchorPoint(.5,.5);var l=r.addComponent(cc.Label);l.width=40,l.horizontalAlign=cc.Label.HorizontalAlign.CENTER,l.string=t.nodes[e].signature+"\n"+Math.floor(100*t.nodes[e].matchvalue)+"%",l.fontSize=18,r.y=-10,i.addChild(r),a.on(cc.Node.EventType.TOUCH_END,function(i){t.cellHandle(e)},t),t.cells[e]=i,t.cellsPoint[e]=[0,0,0]})(this,t)}},tipHandle:function(t){if(cc.log("click  tip ok%d:%d",t),this.tipClicked=!0,this.tipNode.active=!1,cc.sys.ANDROID==cc.sys.platform)jsb.reflection.callStaticMethod("com/faceunity/fulivedemo/MainActivity","clickTip","(Ljava/lang/Integer;)V",t);else if(cc.sys.IOS==cc.sys.platform)jsb.reflection.callStaticMethod("NativeOcInfterface","clickNode")},cellHandle:function(t){if(cc.log("click ok%d:%d",t),cc.sys.ANDROID==cc.sys.platform)jsb.reflection.callStaticMethod("com/faceunity/fulivedemo/MainActivity","clickNode","(Ljava/lang/Integer;)V",t);else if(cc.sys.IOS==cc.sys.platform)jsb.reflection.callStaticMethod("NativeOcInfterface","clickNode")},rotationPos:function(t,e){function i(t,e){var i={};i.column=t,i.row=e,i.matrix=[];for(var a=0;a<t;a++){i.matrix[a]=[];for(var c=0;c<e;c++)i.matrix[a][c]=0}return i}function a(t,e,a){for(var c=i(t,e),o=0;o<t;o++)for(var n=0;n<e;n++)c.matrix[o][n]=a[o][n];return c}function c(t,e){for(var a=i(t.column,e.row),c=0;c<t.column;c++)for(var o=0;o<e.row;o++)for(var n=0;n<t.row;n++)a.matrix[c][o]+=t.matrix[c][n]*e.matrix[n][o];return a}for(var o=0;o<this.cant;o++){var n=this.cellsPoint[o],s=a(1,4,[[n[0],n[1],n[2],1]]);if(t.z*t.z+t.y*t.y!=0)s=c(s,a(4,4,[[1,0,0,0],[0,h=t.z/Math.sqrt(t.z*t.z+t.y*t.y),d=t.y/Math.sqrt(t.z*t.z+t.y*t.y),0],[0,-d,h,0],[0,0,0,1]]));if(t.x*t.x+t.y*t.y+t.z*t.z!=0)s=c(s,a(4,4,[[r=Math.sqrt(t.y*t.y+t.z*t.z)/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),0,-(l=-t.x/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),0],[0,1,0,0],[l,0,r,0],[0,0,0,1]]));var r,l,h,d,u=Math.cos(e),p=Math.sin(e);if(s=c(s,a(4,4,[[u,p,0,0],[-p,u,0,0],[0,0,1,0],[0,0,0,1]])),t.x*t.x+t.y*t.y+t.z*t.z!=0)s=c(s,a(4,4,[[r=Math.sqrt(t.y*t.y+t.z*t.z)/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),0,l=-t.x/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),0],[0,1,0,0],[-l,0,r,0],[0,0,0,1]]));if(t.z*t.z+t.y*t.y!=0)s=c(s,a(4,4,[[1,0,0,0],[0,h=t.z/Math.sqrt(t.z*t.z+t.y*t.y),-(d=t.y/Math.sqrt(t.z*t.z+t.y*t.y)),0],[0,d,h,0],[0,0,0,1]]));s=new cc.Vec3(s.matrix[0][0],s.matrix[0][1],s.matrix[0][2]),this.cellsPoint[o][0]=s.x,this.cellsPoint[o][1]=s.y,this.cellsPoint[o][2]=s.z,o==this.cant&&cc.log("haha");var g=this.cells[o];cc.v2(0,100);g.x=0+s.x*this.radias,g.y=100+s.y*this.radias,g.scale=Math.min(Math.max(s.z,.2),.5),g.opacity=Math.max(50,255*s.z),this.tipNode.zOrder=s.z,o!=this.tipIndex||this.tipClicked||(this.tipNode.x=g.x,this.tipNode.y=g.y+20,this.tipNode.scale=g.scale,this.tipNode.opacity=g.opacity<125?0:g.opacity,this.tipNode.active=g.opacity>125,this.tipNode.zOrder=1e4)}},updatePos:function(t){if(!this.isTouchMoving){var e,i,a,c,o;this.deltaAngle+=.1;for(var n=this.deltaAngle*Math.PI/180,s=0;s<this.cant;s++){i=s*this.offset-1+this.offset/2,c=Math.sqrt(1-Math.pow(i,2)),o=(s+1)%this.cant*this.increment+n,e=Math.cos(o)*c,a=Math.sin(o)*c;var r=this.cells[s];this.cellsPoint[s][0]=e,this.cellsPoint[s][1]=i,this.cellsPoint[s][2]=a;e=0+e*this.radias,i=100+i*this.radias,r.y=100;var l=Math.min(Math.max(a,.2),.8);r.opacity=Math.max(50,255*a);var h=cc.scaleTo(.4,l),d=cc.moveTo(.4,cc.v2(e,i)),u=this,p=cc.sequence([h,d,cc.callFunc(function(){u.initing=!1})]);r.runAction(p)}this.lastDirection=new cc.Vec3(100*Math.random()%10-5,100*Math.random()%10-5,0)}},update:function(t){this.isTouchMoving||this.initing||(this.lastAngle=Math.max(.005,this.lastAngle-5e-4),this.rotationPos(this.lastDirection,this.lastAngle))}}),cc._RF.pop()},{}]},{},["PlanetNode","ShaderUtils","SoulPlanet"]);